<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/Clean-Scripts/EasyGo-Expense-Tracker/refs/heads/main/logo.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <title>Easy Go Admin</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; background: #f4f7f6; }
        .glass-panel { background: rgba(255, 255, 255, 0.98); backdrop-filter: blur(20px); border: 1px solid rgba(0,0,0,0.05); }
        input[type="number"]::-webkit-inner-spin-button { display: none; }
        .tab-active { border-bottom: 3px solid #4f46e5; color: #4f46e5; }
    </style>
</head>
<body class="min-h-screen p-4 md:p-8" style="background: linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.8)), url('https://raw.githubusercontent.com/Clean-Scripts/EasyGo-Expense-Tracker/refs/heads/main/Banner.png') center/cover fixed;">
    
    <div class="max-w-7xl mx-auto glass-panel rounded-[3rem] shadow-2xl p-6 md:p-10">
        <div class="flex flex-col md:flex-row justify-between items-center mb-8 pb-6 border-b">
            <div class="flex items-center gap-4">
                <img src="https://raw.githubusercontent.com/Clean-Scripts/EasyGo-Expense-Tracker/refs/heads/main/logo.png" class="h-14 bg-white rounded-full p-1 shadow">
                <h1 class="text-3xl font-black uppercase text-gray-900 tracking-tighter">Track Sales</h1>
            </div>
            <div class="flex gap-3 mt-4 md:mt-0">
                <input type="password" id="ghToken" placeholder="Cloud Token" class="px-4 py-2 border rounded-xl text-xs w-32 shadow-inner">
                <button onclick="saveToCloud()" class="bg-indigo-600 text-white px-6 py-2 rounded-xl font-bold uppercase text-[10px] shadow-lg hover:scale-105 transition-all">ðŸ’¾ Save Records</button>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            
            <div class="space-y-6">
                <div class="bg-white p-6 rounded-[2rem] border shadow-sm">
                    <h3 class="text-[10px] font-black uppercase text-gray-400 mb-4 tracking-widest">Daily Sales Tracker</h3>
                    <input type="date" id="recordDate" class="w-full mb-4 text-xs font-bold border-b pb-1 outline-none">
                    <div id="salesList" class="space-y-3"></div>
                </div>

                <div class="bg-red-50 p-6 rounded-[2rem] border border-red-100 shadow-sm">
                    <h3 class="text-[10px] font-black uppercase text-red-400 mb-4 tracking-widest">Operational Overheads</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <label class="text-[10px] font-bold text-gray-500 uppercase">Monthly Electricity</label>
                            <input type="number" id="monthlyBill" value="1200" oninput="liveUpdate()" class="w-16 bg-transparent border-b text-right font-bold">
                        </div>
                        <div class="flex justify-between items-center">
                            <label class="text-[10px] font-bold text-gray-500 uppercase">Distributor Delivery</label>
                            <input type="number" id="distribFee" value="50" oninput="liveUpdate()" class="w-16 bg-transparent border-b text-right font-bold">
                        </div>
                        <div class="flex justify-between items-center">
                            <label class="text-[10px] font-bold text-gray-500 uppercase">Travel/Selling Cost</label>
                            <input type="number" id="travelCost" value="40" oninput="liveUpdate()" class="w-16 bg-transparent border-b text-right font-bold">
                        </div>
                        <div class="flex justify-between items-center">
                            <label class="text-[10px] font-bold text-gray-500 uppercase">Daily Home Deliveries</label>
                            <input type="number" id="homeDelCount" value="0" oninput="liveUpdate()" class="w-16 bg-transparent border-b text-right font-bold">
                        </div>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-2 space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-slate-900 rounded-[2.5rem] p-8 text-white shadow-xl relative overflow-hidden">
                        <p class="text-indigo-400 text-[10px] font-bold uppercase tracking-widest">Net EBITDA (Daily)</p>
                        <h2 id="netEbitda" class="text-6xl font-black mt-2">â‚¹0</h2>
                        <div class="mt-4 pt-4 border-t border-slate-800 flex justify-between text-[9px] uppercase font-bold text-slate-400">
                            <span>Inc. GST (5%) & (18%)</span>
                            <span>Inc. Depreciation</span>
                        </div>
                    </div>
                    <div class="bg-white rounded-[2.5rem] p-4 border flex items-center justify-center shadow-sm">
                        <canvas id="mainChart" class="max-h-36"></canvas>
                    </div>
                </div>

                <div class="bg-white rounded-3xl border shadow-xl overflow-hidden">
                    <div class="bg-gray-100 p-3 flex justify-between px-6">
                        <span class="text-[9px] font-black uppercase text-gray-500">Live Item Management</span>
                        <span class="text-[9px] font-black uppercase text-indigo-500">300 Pcs / 2.5kg Base</span>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left text-xs">
                            <thead class="bg-gray-50 font-black text-gray-400 uppercase border-b">
                                <tr>
                                    <th class="p-4">Item</th>
                                    <th>Admin (Pcs)</th>
                                    <th>Cust (g)</th>
                                    <th>Rate</th>
                                    <th>Margin</th>
                                </tr>
                            </thead>
                            <tbody id="inventoryTable" class="divide-y divide-gray-50 font-bold"></tbody>
                        </table>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-green-50 p-6 rounded-[2.5rem] border border-green-100">
                        <h4 class="text-[11px] font-black text-green-700 uppercase mb-4">GST Compliance Tracker</h4>
                        <div class="space-y-2 text-[11px]">
                            <div class="flex justify-between"><span>Output GST (Food 5%):</span><span id="gstFood">â‚¹0</span></div>
                            <div class="flex justify-between"><span>Output GST (Deliv 18%):</span><span id="gstDeliv">â‚¹0</span></div>
                            <div class="flex justify-between border-t pt-2 font-black text-indigo-600"><span>Total GST Payable:</span><span id="totalGst">â‚¹0</span></div>
                        </div>
                    </div>
                    <div class="bg-amber-50 p-6 rounded-[2.5rem] border border-amber-100">
                        <h4 class="text-[11px] font-black text-amber-700 uppercase mb-4">ITR-4 filling helper</h4>
                        <div class="space-y-2 text-[11px]">
                            <div class="flex justify-between"><span>Daily Depreciation:</span><span id="deprecValue">â‚¹0</span></div>
                            <div class="flex justify-between"><span>Presumptive Income:</span><span id="itrProfit">â‚¹0</span></div>
                            <p class="text-[8px] text-amber-600 mt-2">Section 44AD applies (Turnover < 20L)</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Constants for Easy Go
        const FREEZER_COST = 19840;
        const PURCHASE_DATE = new Date('2025-10-01'); // Prorated from start of business
        const FRIES_PACK_G = 2500;
        const FRIES_PACK_PCS = 300;
        const GRAM_PER_PC = FRIES_PACK_G / FRIES_PACK_PCS; // ~7.57g

        let products = [
            { name: "Steamed Veg Momos", raw: 2.82, std: 70, grams: 0, pcs: 8, sold: 0 },
            { name: "Fried Veg Momos", raw: 2.82, std: 80, grams: 0, pcs: 8, sold: 0 },
            { name: "Cheese Corn Steamed", raw: 3.89, std: 90, grams: 0, pcs: 8, sold: 0 },
            { name: "French Fries", raw: 0.76, std: 80, grams: 150, pcs: 96, sold: 0 },
            { name: "Mini Samosas", raw: 7.27, std: 140, grams: 0, pcs: 8, sold: 0 }
        ];

        let chart;

        function friesConverter(type, val, idx) {
            if (type === 'pcs') {
                products[idx].pcs = val;
                products[idx].grams = Math.round(val * GRAM_PER_PC);
            } else {
                products[idx].grams = val;
                products[idx].pcs = Math.round(val / GRAM_PER_PC);
            }
            renderTables();
            liveUpdate();
        }

        function liveUpdate() {
            // Expenses
            const dailyElec = parseFloat(document.getElementById('monthlyBill').value) / 30;
            const dailyDeprec = (FREEZER_COST * 0.15) / 365;
            const distrib = parseFloat(document.getElementById('distribFee').value);
            const travel = parseFloat(document.getElementById('travelCost').value);
            const delCount = parseFloat(document.getElementById('homeDelCount').value);
            
            // Tax Calculations
            let foodRevenue = 0;
            let deliveryRevenue = delCount * 40; // Assuming â‚¹40 delivery fee
            let grossProfit = 0;

            products.forEach(p => {
                const costPerPlate = (p.raw * p.pcs) + 6.39;
                foodRevenue += p.sold * p.std;
                grossProfit += p.sold * (p.std - costPerPlate);
            });

            const foodGst = foodRevenue * 0.05;
            const delivGst = deliveryRevenue * 0.18;
            const totalOpExp = dailyElec + dailyDeprec + distrib + travel + foodGst + delivGst;

            const netEbitda = grossProfit - totalOpExp;

            // Update UI
            document.getElementById('netEbitda').innerText = `â‚¹${Math.round(netEbitda)}`;
            document.getElementById('gstFood').innerText = `â‚¹${foodGst.toFixed(2)}`;
            document.getElementById('gstDeliv').innerText = `â‚¹${delivGst.toFixed(2)}`;
            document.getElementById('totalGst').innerText = `â‚¹${(foodGst + delivGst).toFixed(2)}`;
            document.getElementById('deprecValue').innerText = `â‚¹${dailyDeprec.toFixed(2)}`;
            document.getElementById('itrProfit').innerText = `â‚¹${Math.round(foodRevenue * 0.08)}`;

            updateChart(grossProfit, totalOpExp);
        }

        function renderTables() {
            const table = document.getElementById('inventoryTable');
            table.innerHTML = products.map((p, i) => `
                <tr>
                    <td class="p-4 text-gray-900">${p.name}</td>
                    <td>
                        <input type="number" oninput="friesConverter('pcs', this.value, ${i})" value="${p.pcs}" class="w-12 border-b bg-transparent outline-none">
                    </td>
                    <td>
                        <input type="number" oninput="friesConverter('grams', this.value, ${i})" value="${p.grams}" class="w-12 border-b bg-transparent outline-none ${p.name !== 'French Fries' ? 'opacity-20' : ''}">g
                    </td>
                    <td>â‚¹<input type="number" oninput="products[${i}].std=this.value; liveUpdate()" value="${p.std}" class="w-10"></td>
                    <td class="text-green-600">${(((p.std - (p.raw * p.pcs + 6.39))/p.std)*100).toFixed(0)}%</td>
                </tr>
            `).join('');

            const sales = document.getElementById('salesList');
            sales.innerHTML = products.map((p, i) => `
                <div class="flex justify-between items-center bg-gray-50 p-2 rounded-xl border">
                    <span class="text-[9px] font-black uppercase text-gray-500">${p.name}</span>
                    <input type="number" oninput="products[${i}].sold=this.value; liveUpdate()" value="${p.sold}" class="w-16 border rounded text-center font-bold text-indigo-600">
                </div>
            `).join('');
        }

        function updateChart(profit, expense) {
            const ctx = document.getElementById('mainChart').getContext('2d');
            if(chart) chart.destroy();
            chart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Gross Profit', 'Total Expenses/Tax'],
                    datasets: [{
                        data: [profit, expense],
                        backgroundColor: ['#4f46e5', '#f87171'],
                        borderWidth: 0
                    }]
                },
                options: { cutout: '80%', plugins: { legend: { display: false } } }
            });
        }

        async function saveToCloud() {
            const token = document.getElementById('ghToken').value;
            if(!token) return alert("Please enter GitHub Token to save cloud record.");
            // Logic to push to Clean-Scripts/Easygo-Seller/easygo_data.json
            alert("Record Locked for " + document.getElementById('recordDate').value);
        }

        window.onload = () => {
            document.getElementById('recordDate').valueAsDate = new Date();
            renderTables();
            liveUpdate();
        };
    </script>
</body>
</html>
